{"version":3,"sources":["/home/caizhibang/czb/springboot/learn/Cryia/src/views/account/src/views/account/UserProfile.vue"],"names":[],"mappings":"AAyIA,sBACA,aAAA,CACA,cAAA,CACA,WAAA,CACA,iBAAA,CACA,QACA,CAEA,iCACA,wBACA,CAEA,kCACA,wBACA,CACA,gBACA,WAAA,CACA,gBACA,CAEA,iBACA,iBACA,CACA,4BACA,yBAAA,CACA,iBAAA,CACA,cAAA,CACA,iBAAA,CACA,eACA,CACA,kCACA,oBACA,CACA,sBACA,cAAA,CACA,aAAA,CACA,eAAA,CACA,WAAA,CACA,YAAA,CACA,iBAAA,CACA,iBAAA,CACA,iBAAA,CACA,yBACA,CACA,QACA,WAAA,CACA,YAAA,CACA,aACA","file":"app.e28063ecc694.css","sourcesContent":["<template>\n  <div class=\"info-container\">\n    <div style=\"float: left\">\n      <el-form :model=\"ruleForm\" status-icon :rules=\"rules\" ref=\"ruleForm\" label-width=\"100px\" class=\"demo-ruleForm\">\n        <el-form-item label=\"原密码\" prop=\"oldPassword\">\n          <el-input type=\"password\" v-model=\"ruleForm.oldPassword\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"新密码\" prop=\"newPassword\">\n          <el-input type=\"password\" v-model=\"ruleForm.newPassword\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"确认密码\" prop=\"checkPassword\">\n          <el-input type=\"password\" v-model=\"ruleForm.checkPassword\" autocomplete=\"off\"></el-input>\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"submitForm('ruleForm')\">提交</el-button>\n          <el-button @click=\"resetForm('ruleForm')\">重置</el-button>\n        </el-form-item>\n      </el-form>\n    </div>\n    <div style=\"float: left;margin-left:50px;\">\n      <el-upload\n        class=\"avatar-uploader\"\n        :action=\"uploadUrl\"\n        :show-file-list=\"false\"\n        :on-success=\"handleAvatarSuccess\"\n        :before-upload=\"beforeAvatarUpload\">\n        <img :src=\"avatar\" class=\"avatar\">\n        <div class=\"el-upload__tip\" slot=\"tip\">点击更改头像</div>\n      </el-upload>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex'\n\nexport default {\n  name: 'UserProfile',\n  data () {\n    var validatePass = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('请输入密码'))\n      } else if (value.length < 6) {\n        callback(new Error('密码必须大于6位字符'))\n      } else {\n        if (this.ruleForm.checkPass !== '') {\n          this.$refs.ruleForm.validateField('checkPass')\n        }\n        callback()\n      }\n    }\n    var validatePass2 = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('请再次输入密码'))\n      } else if (value !== this.ruleForm.newPassword) {\n        callback(new Error('两次输入密码不一致!'))\n      } else {\n        callback()\n      }\n    }\n    return {\n      imageUrl: 'https://wpimg.wallstcn.com/f778738c-e4f8-4870-b634-56703b4acafe.gif',\n      uploadUrl: '',\n      ruleForm: {\n        oldPassword: '',\n        newPassword: '',\n        checkPassword: ''\n      },\n      rules: {\n        oldPassword: [\n          { validator: validatePass, trigger: 'blur' }\n        ],\n        newPassword: [\n          { validator: validatePass, trigger: 'blur' }\n        ],\n        checkPassword: [\n          { validator: validatePass2, trigger: 'blur' }\n        ]\n      }\n    }\n  },\n  computed: {\n    ...mapGetters([\n      'avatar'\n    ])\n  },\n  methods: {\n    handleAvatarSuccess (res, file) {\n      this.imageUrl = URL.createObjectURL(file.raw)\n    },\n    beforeAvatarUpload (file) {\n      const isPNG = file.type === 'image/png'\n      const isJPG = file.type === 'image/jpeg'\n      const isGIF = file.type === 'image/gif'\n      const isLt2M = file.size / 1024 / 1024 < 2\n      console.log(file)\n      if (!isJPG && !isPNG && !isGIF) {\n        this.$message.error('上传头像图片只能是 JPG/PNG/GIF 格式!')\n      }\n      if (!isLt2M) {\n        this.$message.error('上传头像图片大小不能超过 2MB!')\n      }\n      return (isJPG || isPNG || isGIF) && isLt2M\n    },\n    resetForm (formName) {\n      this.$refs[formName].resetFields()\n    },\n    submitForm (formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          this.$store.dispatch('UpdateAccount', this.ruleForm).then(response => {\n            if (response.code === 0) {\n              this.$message({\n                message: '密码修改成功, 请重新登陆',\n                type: 'success',\n                duration: 3000\n              })\n\n              const that = this\n              setTimeout(() => {\n                that.$store.dispatch('LogOut').then(() => {\n                  location.reload()\n                })\n              }, 3000)\n            }\n          })\n        } else {\n          console.log('error submit!!')\n          return false\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style>\n  .el-carousel__item h3 {\n    color: #475669;\n    font-size: 14px;\n    opacity: 0.75;\n    line-height: 100px;\n    margin: 0;\n  }\n\n  .el-carousel__item:nth-child(2n) {\n    background-color: #99a9bf;\n  }\n\n  .el-carousel__item:nth-child(2n+1) {\n    background-color: #d3dce6;\n  }\n  .info-container{\n    width:800px;\n    padding-top:50px;\n  }\n\n  .avatar-uploader{\n    text-align: center;\n  }\n  .avatar-uploader .el-upload {\n    border: 1px dashed #d9d9d9;\n    border-radius: 6px;\n    cursor: pointer;\n    position: relative;\n    overflow: hidden;\n  }\n  .avatar-uploader .el-upload:hover {\n    border-color: #409EFF;\n  }\n  .avatar-uploader-icon {\n    font-size: 50px;\n    color: #8c939d;\n    font-weight: bold;\n    width: 120px;\n    height: 120px;\n    line-height: 120px;\n    text-align: center;\n    border-radius: 4px;\n    border:1px dashed #dcdfe6;\n  }\n  .avatar {\n    width: 120px;\n    height: 120px;\n    display: block;\n  }\n</style>\n"]}